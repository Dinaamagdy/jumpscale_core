syntax = "proto3";

package blockchain;

//ask for a specific action
message Message {
    string guid = 1; //unique address on the blockchain (per new mod there is a new version of the object)
    string objguid = 2; //unique addr for object over time
    string previous = 3; // link to previous unique address (to the previous guid)
    string data = 4; //the payload
    string category = 5;//each object is in specific category

    unint32 date =6;
    string author =7 ; //guid of author is in category person
    string signature = 8; //signature done by private key of person

    enum Compression {
      NONE = 0;
      BLOSC = 1;
      SNAPPY = 2;
    }
    Compression compression_type = 9;

    uint32 expiration = 10; //after that date the data is no longer usable/valid


    
  
    Status status = 6;
    ServicePointer service = 2; //know where to execute thx to service
    string action = 3; //the name of the action we want to execute
    DomainPointer domain = 4;
      
  
      
  }

message Decrypt {
  string userguid = 1; //can be a group too (a group has also a private key)
  //symmetrical encryption key which has been encrypted with the public key of the user 
  //encryption key was: blake_hash_256+random 4bytes (salt)
  //encryption done by means of TOBEDEFINED???
  string encrkey =2 ; 

}

message Job {
  string guid = 1;
  string jobrequest_guid = 2;
  ServicePointer service = 3;
  string action = 4; //the name of the action we want to execute
  DomainPointer domain = 5;
  
  enum Status {
    INIT = 0;
    RUNNING = 1;
    OK = 2;
    ERROR = 3;
  }

  Status status = 6;

  string args = 7; //is protobuf encoded msg  

  uint32 time_start = 8; //epoch when to start
  uint32 time_stop = 9; //epoch when to start

}

message JobRecurring {
    string guid = 1;
    ServicePointer service = 2;
    string action = 3; //the name of the action we want to execute
    DomainPointer domain = 4;
    
    enum Status {
      INIT = 0;
      OK = 1;
      ERROR = 2;
      SCHEDULED = 3;
    }
  
    Status status = 5;
  
    string args = 6; //is protobuf encoded msg  
  
    uint32 startdate = 7; //epoch when to start
    uint32 deadline = 8; //last time 
    uint32 maxretry = 9; //how many times to retry if error
  
  }